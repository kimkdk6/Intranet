<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dao.SignDAO">
	
	<!-- 결재문서함>미결재문서 리스트 가져오기 -->
	<select id="getUnSigns" parameterType="String" resultType="dto_vo.Sign.Sign">
		select *
		from sign s join signline sl
		on s.DOCNUM = sl.DOCNUM
		where signstate = 0 and sl.SIGNNING like #{userid} and sl.SIGNNING != s.userid
	
	</select>
	
	<!-- 개인문서함>상신문서 리스트 가져오기 -->
	 <select id="getSendSigns" resultType="dto_vo.Sign.Sign">
		select * 
		from sign
		where userid = #{userid}
	</select> 
	
	<!-- 결재 문서 상세보기 문서 하나 가져오기 -->
	<select id="getSign" resultType="dto_vo.Sign.Sign">
		select * 
		from sign
		where docnum = #{docnum}
	</select> 
	
	<!-- 결재 > 기안서 상세보기 가져오기 -->
	<select id="getDraftingdoc" resultType="dto_vo.Sign.Draftingdoc">
		select * 
		from DRAFTINGDOC
		where docnum = #{docnum}
	</select>
	
	<!-- 결재 라인 가져오기  -->
	<select id="getSignline" resultType="dto_vo.Sign.Signline">
		select * 
		from signline
		where docnum = #{docnum}
	</select>
	
	<!-- 부서 목록 가져오기  -->
	<select id="getDepts" resultType="dto_vo.Emp.Dept">
		select *
		from dept
	</select>
	
	<!-- 사원 목록 가져오기  -->
	<select id="getEmps" resultType="dto_vo.Emp.Emp">
		select *
		from emp
	</select>
	<!-- 팀 목록 가져오기  -->
	<select id="getTeams" resultType="dto_vo.Emp.Team">
		select *
		from team
	</select>
	<!-- 직급 목록 가져오기  -->
	<select id="getPositions" resultType="dto_vo.Emp.Position">
		select *
		from position
	</select>
	
	<!-- 결재 작성 -->
	<select id="insertSign" parameterType="dto_vo.Sign.Sign">
		insert into sign(docnum, userid, signtype, dept, team,  
                 		 signfilesrc, signtitle, signnote, 
               		     signer1, signer2, signer3, signer4, signer5,
                 		 ename, posname)
                  values(sign_docnum.nextval, #{userid}, #{signtype}, ${dept}, ${team}, 
                         null, #{signtitle}, #{signnote}, 
                         #{signer1},  #{signer2},  #{signer3},  #{signer4},  #{signer5},
                         #{ename}, #{posname})
	</select>
	<!-- 결재 라인 작성 -->
	<select id="insertSignline" parameterType="dto_vo.Sign.Signline">
		insert into SIGNLINE(docnum, signok2, signok3, signok4, signok5, signning)
            		  values(sign_docnum.currval, 
            		  		 #{signok2}, #{signok3}, #{signok4}, #{signok5}, )
	</select>
	
	<!-- 기안서 작성 -->
	<select id="insertDrafting" parameterType="dto_vo.Sign.Draftingdoc">
		insert into DRAFTINGDOC(docnum, dracontent)
            			 values(sign_docnum.currval, #{dracontent})
	</select>

</mapper>
