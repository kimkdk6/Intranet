<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    <mapper namespace="dao.AttendanceDAO">

    <insert id="checkin"  parameterType="String">
  	insert into attendance(userid,attdate,attstarttime) values( #{userid}, to_char (sysdate, 'YYYY-MM-DD'), sysdate )
    </insert>
    
    <update id="checkout" parameterType="String">							
	update attendance set attendtime = sysdate where userid = #{userid} and to_char (attstarttime, 'YYYY-MM-DD') = to_char (sysdate, 'YYYY-MM-DD')
    </update>
    
      <select id="checkincheck" parameterType="String" resultType="String" >
 	select to_char (attstarttime, 'HH24:MI:SS') from attendance where userid = #{userid} and to_char (attdate, 'YYYY-MM-DD') = to_char (sysdate, 'YYYY-MM-DD')
    </select>
    
    <select id="checkoutcheck" parameterType="String" resultType="String" >
 	select to_char (attendtime, 'HH24:MI:SS') from attendance where userid = #{userid} and to_char (attdate, 'YYYY-MM-DD') = to_char (sysdate, 'YYYY-MM-DD')
    </select>
    
      <select id="latecheck" parameterType="String" resultType="String" >
		select to_char (compstart, 'HH24:MI:SS') from company where to_char (compstart,'HH24') <![CDATA[   <  ]]> (select to_char (attstarttime,'HH24') from attendance where userid = #{userid} and to_char (attdate, 'YYYY-MM-DD') = to_char (sysdate, 'YYYY-MM-DD') )
    </select>
    
    <insert id="letereason"  parameterType="String">
		insert into lateness(userid,attdate,ltreason) values (#{param1}, to_char (sysdate, 'YYYY-MM-DD'), #{param2})   
	</insert>
    
   
  </mapper>